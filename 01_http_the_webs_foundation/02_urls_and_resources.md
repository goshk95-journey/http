# 02.URL과 리소스

**URL은 인터넷의 리소스를 가리키는 표준 이름이다.** URL은 전자정보 일부를 가리키고 그것이 어디에 있고 어떻게 접근할 수 있는지 알려준다.

## 2.1 인터넷의 리소스 탐색하기

URL은 HTTP 프로토콜이 아닌 다른 가용한 프로토콜을 사용할 수도 있다.

- `mailto:user@abc.com`
- `ftp://ftp.abc.com/index.html`

이렇게 **URL은 인터넷에 있는 어떤 리소스든지 가리킬 수 있다.**

### 2.1.1 URL이 있기 전 암흑의 시대

웹과 URL이 있기 전에 사람들은 네트워크상에 산재해 있는 데이터의 접근하기 위해서, 오합지졸에 가까울 정도로 **애플리케이션마다 달리 가지고 있는 분류 방식을 사용했다.**

오늘날 브라우저들은 이러한 기능들을 한 개의 편리한 패키지에 담아놓았다. URL을 사용하면 이런 애플리케이션들에서 하나의 인터페이스를 통해 **일관된 형식**으로 많은 리소스에 접근할 수 있다.

## 2.2 URL 문법

URL 문법은 스킴에 따라 달라진다.

대부분의 URL 스킴의 문법은 일반적으로 9개의 부분으로 나뉜다.

***{스킴}://{사용자 이름}:{비밀번호}@{호스트}:{포트}/{경로};{파라미터}?{질의}#{프라그먼트}***

### 2.2.1 스킴:사용할 프로토콜

**스킴은 주어진 리소스에 어떻게 접근하는지 알려주는 중요한 정보다.**

스킴 명은 대소문자를 가리지 않으므로 `http:www.google.com`과 `HTTP:www.google.com`은 같다.

### 2.2.2 호스트와 포트

호스트 컴포넌트는 접근하려고 하는 리소스를 가지고 있는 인터넷상의 호스트 장비를 가리킨다.

포트 컴포넌트는 사용자가 열어놓은 네트워크 포트를 가리킨다. 내부적으로 TCP 프로토콜을 사용하는 HTTP는 기본 포트로 80을 사용한다.

### 2.2.3 사용자 이름과 비밀번호

많은 서버가 자신이 가지고 있는 데이터에 접근을 허용하기 전에 사용자 이름과 비밀번호를 요구한다.

여기 몇 가지 예가 있다.

- `ftp://ftp.prep.ai.mit.edu/pub/gnu`
- `ftp://anonymous@ftp.prep.ai.mit.edu/pub/gnu`
- `ftp://anonymous:my_password@ftp.prep.ai.mit.edu/pub/gnu`
- `ftp://joe:joe_password@www.joes-hardware.com/sales_info.txt`

첫 번째 예의 경우 만약 애플리케이션이 사용자 이름과 비밀번호를 요구하는 URL 스킴을 사용한다면, **사용자 이름은 'anonymous' 비밀번호는 브라우저마다 가지고 있는 기본값을 기본값으로 사용한다.**

### 2.2.4 경로

URL의 경로 컴포넌트는 리소스가 서버의 어디에 있는지 알려준다. 

URL의 경로는 유닉스 파일 시스템의 파일 경로와 유사하게 '/'문자를 기준으로 경로조각으로 나뉜다.

### 2.2.5 파라미터

많은 스킴이 객체애 대한 호스트 및 경로 정보만으로는 리소스를 찾지 못한다.

URL의 파라미터 컴포넌트는, 애플리케이션이 서버에 정확한 요청을 하기 위해 필요한 입력 파라미터를 받는데 사용한다. 이 컴포넌트는 이름/값 쌍의 리스트로 URL 나머지 부분들로부터 ';'문자로 구분하여 URL에 기술한다. 이를 통해 **애플리케이션이 리소스에 접근하는데 필요한 어떤 추가 정보든 전달할 수 있다.**

### 2.2.6 질의 문자열

데이터베이스 같은 서비스들은 요청받을 리소스 형식의 범위를 좁히기 위해서 질문이나 질의를 받을 수 있다.

`http://www.abc.com/hello?id=1&name=hong`

질의 컴포넌트 포맷에 제약사항은 없다. 편의상 많은 게이트웨이가 '&'로 나뉜 '이름=값'쌍 형식의 질의 문자열을 원한다.

### 2.2.7 프라그먼트

리소스의 특정 부분을 가리킬 수 있도록, URL은 리소스 내의 조각을 가리킬 수 있는 프라그먼트 컴포넌트를 제공한다. 예를 들어 URL은 HTML 문서에 있는 특정 이미지나 일부분을 가리킬 수 있다.

일반적으로 HTTP 서버는 객체 일부가 아닌 전체만 다루기 때문에, 클라이언트는 서버에 프라그먼트를 전달하지 않는다.

## 2.3 단축 URL

웹 클라이언트는 몇몇 단축 URL을 인식하고 사용한다.

### 2.3.1 상대 URL

URL은 **상대 URL**과 **절대 URL** 두 가지로 나뉜다. 

절대 URL은 리소스에 접근하는데 필요한 모든 정보를 가지고 있다. 그와 달리 상대 URL은 모든 정보를 담고 있지 않으며, 필요한 정보를 얻기 위해서 기저(base)라고 하는 다른 URL을 사용해야 한다.


상대 URL이 포함된 HTML 문서의 예

```html
<html>
  <head>
    <title>Hello World</title>
  </head>
  <body>
    <a href="./hammers.html">hammers</a>
  </body>
</html>
```

해당 HTML을 보면 `./hammers.html` URL을 가리키는 하이퍼링크가 있다. 이는 문서의 URL을 기준으로 상대경로로 해석될 수 있다.

상대 URL 문법에 따르면, 스킴, 호스트 그리고 다른 컴포넌트들을 모두 입력하지 않아도 된다. 그 정보는 컴포넌트가 포함된 리소스의 기저 URL에서 알아낼 수 있다.

### 기저 URL을 찾는 방법

**리소스에서 명시적으로 제공**

`<base>` HTML 태그를 사용하여 기저 URL을 명확하게 기술한다.

**리소스를 포함하고 있는 기저 URL**

만약 기저 URL이 명시되지 않은 경우, 해당 리소스의 URL을 기저 URL로 사용할 수 있다.

**기저 URL이 없는 경우**

기저 URL이 없는 경우도 있다. 보통 이런 경우는 절대 URL만으로 이루어져 있다는 뜻이다. 하지만 불완전하거나 깨진 URL일 수도 있다.

### 2.3.2 URL 확장

**호스트 명 확장**

호스트 명 확장 기능을 지원하는 브라우저는 단순한 휴리스틱만을 사용해서 입력한 호스트 명을 전체 호스트 명으로 확장할 수 있다.

예를 들어 주소 입력란에 `yahoo`를 입력하면, 브라우저는 호스트 명에 자동으로 `wwww`, `com`을 붙여서 `www.yahoo.com`을 만든다. 만약 `yahoo`를 찾지 못하는 브라우저라면 확장을 포가하기 전에 몇 가지 URL을 추가로 제시한다.

매우 편리한 기능이지만 **호스트 명에 대한 확장 기능은 프록시와 같은 다른 HTTP 애플리케이션에 문제를 발생시킬 수도 있다.**

**히스토리 확장**

URL 입력 시간을 줄이고자, 사용자가 이전에 방문했던 URL 기록을 저장하는 기능이다. 사용자가 URL의 일부를 입력하면 해당 글자를 포함하는 URL을 찾아서 완결된 형태의 URL들을 선택하게 해준다.

## 2.4 안전하지 않은 문자

URL 설계자들은, 모든 인터넷 프로토콜로 URL이 **안전하게 전송**될 수 있기를 바랬다.

> 안전한 전송이란, 정보가 유실될 위험 없이 URL을 전송할 수 있다는 것을 의미한다.

그리고 가독성도 있기를 바랬다.

이러한 이유로 URL 설계자들은 다음과 같은 규칙을 만들었다.

### 2.4.1 URL 문자 집합

역사적으로 많은 컴퓨터 애플리케이션이 `US-ASCII` 문자 집합을 사용해 왔다.

`US-ASCII`는 미국 시민들 사이에서는 편리하게 쓰이고 있기는 하지만, 전 세계 십수억의 사람들이 사용하는 언어들에 존재하는 변형된 문자들까지 지원하지 않는다.

이런 경우를 지원하기 위해서 **이스케이프 문자열**을 쓸 수 있게 설계하였다.

### 2.4.2 인코딩 체계

URL에 있는 안전하지 않은 문자들을 표현할 수 있는 인코딩 방식이 고안되었다. 인코딩은 안전하지 않은 문자를 퍼센티지 기호(%)로 시작해, ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 이스케이프 문자로 바꿔준다.

ex)

- `~` => `%7E`
- `빈 문자` => `%20`
- `%` => `%25`

### 2.4.3 문자 제한

몇몇 문자는 URL 내에서 특별한 의미로 예약되어 있다.

### URL 예약어

|    문자    | 선점 및 제한                                         |
|-----------|---------------------------------------------------|
| %         | 인코딩된 문자에 사용할 이스케이프 토큰으로 선점               |
| /         | 경로 컴포넌트에 있는 경로 세그먼트를 나누는 용도로 선점               |
| .         | 경로 컴포넌트에서 선점               |
| ..        | 경로 컴포넌트에서 선점                             |
| #         | 프라그먼트 구획 문자로 선점               |
| ?         | 질의 문자열의 구획 문자로 선점               |
| :         | 스킴, 사용자 이름/비밀번호, 호스트/포트의 구획 문자로 선점               |
| @ & =         | 특정 스킴에서 특별한 의미가 있기 때문에 선점               |
| { } \| \ ~ [ ] ・          | 게이트웨이와 같은 여러 전송 에이전트에서 불안전하게 다루기 때문에 선점               |
